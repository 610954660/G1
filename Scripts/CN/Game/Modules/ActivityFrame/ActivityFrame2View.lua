--Name : ActivityFrame2View.lua
--Author : generated by FairyGUI
--Date : 2020-5-9
--Desc : added by xhd UI框架模态2

local ActivityFrameViewBase = require "Game.Modules.ActivityFrame.ActivityFrameViewBase"
local ActivityFrame2View,Super = class("ActivityFrame2View", ActivityFrameViewBase)
local ActivityMap = require "Game.Modules.Activity.ActivityMap"
function ActivityFrame2View:ctor()
	self._packName = "ActivityFrame"
	self._compName = "ActivityFrame2View"
end

function ActivityFrame2View:_initEvent( )
end

function ActivityFrame2View:close_ActivityView( mainActiveId,actType )
	local inFlag = false
	local mid = 0 
	if mainActiveId then
		mid = mainActiveId
		inFlag = true
	else
		mid = self.mainActiveId
	end
	
	if (not mainActiveId) and actType then
		--确定当前关闭的活动在这个集合当中
		for i = 1, #self.viewData do
			if self.viewData[i].type == actType then
				inFlag = true
			end
		end
	end

	if not inFlag then --活动不在的框架  直接return
		return 
	end
	self:closeView()
	local viewData = ActivityModel:marketUIWinData(mid) 
	if not viewData then
		return
	end
	
	--限时礼包特殊操作
	for k,v in pairs(viewData) do
    	if v.actType == GameDef.ActivityType.SurpriseGift then
    		table.remove(viewData,k)
    	end
	end

    if (viewData and (#viewData > 0)) then
        ViewManager.open(self._viewName,{viewData =viewData,page = viewData[1].page})
    else
        RollTips.show(Desc.activity_txt1);
	end
end

return ActivityFrame2View