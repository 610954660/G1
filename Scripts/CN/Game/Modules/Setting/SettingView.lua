--Name : SettingView.lua
--Author : generated by FairyGUI
--Date : 2020-6-6
--Desc : 

local SettingView,Super = class("SettingView", MutiWindow)

function SettingView:ctor()
	--LuaLog("SettingView ctor")
	self._packName = "Setting"
	self._compName = "SettingView"
	self._rootDepth = LayerDepth.Window
	self._isFullScreen = true
	self.curIndex = 0
end

function SettingView:_initEvent( )
	
end

function SettingView:_initVM( )
	local vmRoot = self
	local viewNode = self.view
	---Do not modify following code--------
	--{vmFields}:Setting.SettingView
		vmRoot.moreList = viewNode:getChildAutoType("GameSettingView/$moreList")--list
		vmRoot.btn_def = viewNode:getChildAutoType("SoundSettingView/$btn_def")--Button
		vmRoot.displayList = viewNode:getChildAutoType("GameSettingView/$displayList")--list
		vmRoot.dslider = viewNode:getChildAutoType("GameSettingView/$dslider")--Slider
		vmRoot.openBt = viewNode:getChildAutoType("GameSettingView/$openBt")--Button
		vmRoot.btn_add = viewNode:getChildAutoType("GameSettingView/$btn_add")--Button
		vmRoot.btn_back = viewNode:getChildAutoType("GameSettingView/$btn_back")--Button
		vmRoot.soundList = viewNode:getChildAutoType("SoundSettingView/$soundList")--list
	--{vmFieldsEnd}:Setting.SettingView
	--Do not modify above code-------------
end

function SettingView:_initUI( )
	self:_initVM()
	
	self:setBg("bg_generalA.jpg")
	
	self._tabBar:setItemRenderer(function(index,obj)
		if index == 2 then
			obj:addEventListener(FUIEventType.Click, function(  )
					self:backToLogin()
			end,33);

		end
		if index==0 then
			local img_red= obj:getChild('img_red')
			RedManager.register( "V_BASESETTINGRED" ,img_red)
		end

	end)

	self._tabBar:setNumItems(3)
	self._tabBar:setSelectedIndex(0)

end

function SettingView:_viewChangeCallBack(index)
	self.curIndex = index
end

function SettingView:backToLogin()
	local info = {}
	info.title = Desc.login_reloginTips
	info.text = Desc.login_changetips
	info.type = "yes_no"
	info.mask = true
	info.onYes = function()
		if __SDK_LOGIN__ then
			LuaLogE("G1 sdk logout",__SDK_LOGIN__)
			SDKUtil.logout()
		else
			LuaLogE("G1 logout",__SDK_LOGIN__)
			FlowManager.backToLogin()
		end
	end
	info.onNo = function()
		self._tabBar:setSelectedIndex(self.curIndex)
	end

	local view = Alert.show(info)
	--view.view:getChildAutoType("frame"):getController("c5"):setSelectedIndex(1)
	view.view:getChildAutoType("frame"):getController("c6"):setSelectedIndex(1)

end

function SettingView:_exit()
	Scheduler.scheduleNextFrame(function ()
		ViewManager.fitAllViews()
	end)
	
	SettingModel:saveSettingData()
end

return SettingView