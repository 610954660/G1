--Name : SoundSettingView.lua
--Author : generated by FairyGUI
--Date : 2020-6-6
--Desc : 

local SoundSettingView,Super = class("SoundSettingView", View)

function SoundSettingView:ctor()
	--LuaLog("SoundSettingView ctor")
	self._packName = "Setting"
	self._compName = "SoundSettingView"
	--self._rootDepth = LayerDepth.Window
	
end

function SoundSettingView:_initEvent( )
	
end

function SoundSettingView:_initVM( )
	local vmRoot = self
	local viewNode = self.view
	---Do not modify following code--------
	--{vmFields}:Setting.SoundSettingView
		vmRoot.soundList = viewNode:getChildAutoType("$soundList")--list
		vmRoot.btn_def = viewNode:getChildAutoType("$btn_def")--Button
	--{vmFieldsEnd}:Setting.SoundSettingView
	--Do not modify above code-------------
end

function SoundSettingView:_initUI( )
	self:_initVM()
	self._dslider = {}
	self.soundList:setItemRenderer(function(index,obj)
			local dslider = obj:getChildAutoType("slider")
			--printTable(33,"ppp = ",index,SettingModel.data.sound,SettingModel.data.sound[index+1])
			dslider:setValue(SettingModel.data.sound[index+1])
			dslider:getChildAutoType("num"):setText(SettingModel.data.sound[index+1])
			local function onChanged( ... )
				local value = math.floor(dslider:getValue()+0.5)
				SettingModel.data.sound[index+1] = value
				dslider:getChildAutoType("num"):setText(SettingModel.data.sound[index+1])
				SettingModel:updateSound(index+1)
			end
			dslider:addEventListener(FUIEventType.Changed, onChanged);
			self._dslider[index+1] = dslider
			obj:getChildAutoType("btn_add"):addClickListener(function()
					SettingModel.data.sound[index+1] = 100
					--if SettingModel.data.sound[index+1] > 100 then
						--SettingModel.data.sound[index+1] = 100
					--end
					
					dslider:setValue(SettingModel.data.sound[index+1])
					dslider:getChildAutoType("num"):setText(SettingModel.data.sound[index+1])
					SettingModel:updateSound(index+1)
				end,33)
			obj:getChildAutoType("btn_back"):addClickListener(function()
					SettingModel.data.sound[index+1] = 0
					--if SettingModel.data.sound[index+1]< 0 then
						--SettingModel.data.sound[index+1] = 0
					--end
					dslider:setValue(SettingModel.data.sound[index+1])
					dslider:getChildAutoType("num"):setText(SettingModel.data.sound[index+1])
					SettingModel:updateSound(index+1)
				end,33)
	end)

	self.soundList:setNumItems(2)
	
	self.btn_def:addClickListener(function()
			SettingModel.data.sound[1] = 60
			SettingModel.data.sound[2] = 60
			self._dslider[1]:setValue(SettingModel.data.sound[1])
			self._dslider[1]:getChildAutoType("num"):setText(SettingModel.data.sound[1])
			self._dslider[2]:setValue(SettingModel.data.sound[2])
			self._dslider[2]:getChildAutoType("num"):setText(SettingModel.data.sound[2])
			SettingModel:updateSound(1)
			SettingModel:updateSound(2)
		end)
end




return SoundSettingView