--Date :2020-12-24
--Author : generated by FairyGUI
--Desc : 

local CollectWordsActivityExchangeView,Super = class("CollectWordsActivityExchangeView", Window)

function CollectWordsActivityExchangeView:ctor()
	--LuaLog("CollectWordsActivityExchangeView ctor")
	self._packName = "CollectWordsActivity"
	self._compName = "CollectWordsActivityExchangeView"
	self._rootDepth = LayerDepth.PopWindow
	self.data 	   = self._args
end

function CollectWordsActivityExchangeView:_initEvent( )
	
end

function CollectWordsActivityExchangeView:_initVM( )
	local viewNode = self.view
	---Do not modify following code--------
	--{autoFields}:CollectWordsActivity.CollectWordsActivityExchangeView
	self.blackbg = viewNode:getChildAutoType('blackbg')--GLabel
	self.btn_add = viewNode:getChildAutoType('btn_add')--GButton
	self.btn_max = viewNode:getChildAutoType('btn_max')--GButton
	self.btn_min = viewNode:getChildAutoType('btn_min')--GButton
	self.btn_sub = viewNode:getChildAutoType('btn_sub')--GButton
	self.btn_take = viewNode:getChildAutoType('btn_take')--GButton
	self.frame = viewNode:getChildAutoType('frame')--GLabel
	self.itemCell = viewNode:getChildAutoType('itemCell')--GButton
	self.txt_num = viewNode:getChildAutoType('txt_num')--GTextField
	--{autoFieldsEnd}:CollectWordsActivity.CollectWordsActivityExchangeView
	--Do not modify above code-------------
end

function CollectWordsActivityExchangeView:_initListener( )
	
end

function CollectWordsActivityExchangeView:_initUI( )
	self:_initVM()
	self:_initListener()
	self:refreshPanel()
end

function CollectWordsActivityExchangeView:refreshPanel()
	local buyTime 	= self.data.buyTime
	local reward 	= self.data.reward
	local itemCell 	= BindManager.bindItemCell(self.itemCell)
	itemCell:setData(reward.code, reward.amout, reward.type)
	-- itemCell:setIsBig(true)
	-- itemCell:setNoFrame(true)
	-- self.itemCell:setScale(2,2)
	local buyNum 	= buyTime  -- 购买数量
	local haveMoney = 0
	-- haveMoney =  ModelManager.PackModel:getItemsFromAllPackByCode(costRes.code)
	self.txt_num:setText(buyNum)
	self.btn_max:removeClickListener(888)
	self.btn_max:addClickListener(function()
		buyNum = buyTime
		self.txt_num:setText(buyNum)
	end,888)

	self.btn_sub:removeClickListener(888)
	self.btn_sub:addClickListener(function()
		if buyNum > 1 then
			buyNum = buyNum - 1
		end
		self.txt_num:setText(buyNum)
	end,888)

	self.btn_add:removeClickListener(888)
	self.btn_add:addClickListener(function()
		if buyNum < buyTime then
			buyNum = buyNum + 1
		end
		self.txt_num:setText(buyNum)
	end,888)

	self.btn_min:removeClickListener(888)
	self.btn_min:addClickListener(function()
		buyNum = 1
		self.txt_num:setText(buyNum)
	end,888)

	self.btn_take:removeClickListener(11)
	self.btn_take:addClickListener(function()  
		local reqInfo ={
			exchangeId = self.data.id,
			amount 	= buyNum,
		}
		RPCReq.Activity_CollectWords_OnExchange(reqInfo,function(params)
		
		end)
		ViewManager.close("CollectWordsActivityExchangeView")
	end,11)

end




return CollectWordsActivityExchangeView