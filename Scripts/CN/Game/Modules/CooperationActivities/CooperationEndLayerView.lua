--Date :2021-01-18
--Author : generated by FairyGUI
--Desc :

local CooperationEndLayerView, Super = class("CooperationEndLayerView", Window)

function CooperationEndLayerView:ctor()
    --LuaLog("CooperationEndLayerView ctor")
    self._packName = "CooperationActivities"
    self._compName = "CooperationEndLayerView"
    self._rootDepth = LayerDepth.PopWindow
    self.activeTag = GameDef.ActivityType.WorkTogetherAct
end

function CooperationEndLayerView:_initEvent()
end

function CooperationEndLayerView:_initVM()
    local viewNode = self.view
    ---Do not modify following code--------
    --{autoFields}:CooperationActivities.CooperationEndLayerView
	self.blackBg = viewNode:getChildAutoType('blackBg')--GLabel
	self.spineParent = viewNode:getChildAutoType('spineParent')--GLoader
	self.spineParentDown = viewNode:getChildAutoType('spineParentDown')--GLoader
	self.spineParentUp = viewNode:getChildAutoType('spineParentUp')--GLoader
	self.txt_challge = viewNode:getChildAutoType('txt_challge')--GButton
	self.txt_hold = viewNode:getChildAutoType('txt_hold')--GButton
	self.txt_max = viewNode:getChildAutoType('txt_max')--GTextField
	self.txt_value = viewNode:getChildAutoType('txt_value')--GTextField
 --{autoFieldsEnd}:CooperationActivities.CooperationEndLayerView
    --Do not modify above code-------------
end

function CooperationEndLayerView:_initEvent(...)
    self.txt_hold:addClickListener(
        function(...)
            CooperationActivitiesModel:WorkTogetherSaveScore(self.activeTag)
            self:closeView()
        end
    )

    self.txt_challge:addClickListener(
        function(...)
            local info = {}
            info.text = "重试将消除本次挑战记录,但不消耗挑战次数"
            info.title = "重试确认"
            info.yesText = Desc.materialCopy_str3
            info.noText = Desc.materialCopy_str4
            info.okText = "okText"
            info.noClose = "yes"
            info.type = "yes_no"
            info.mask = true
            info.onClose = function()
            end
            info.onYes = function()
                self:closeView()
            end
            info.onNo = function()
            end
            Alert.show(info)
        end
    )
end

function CooperationEndLayerView:_initUI()
    self:_initVM()
    local info = CooperationActivitiesModel.battleResult
    self.txt_value:setText(info.addScore)
    self.txt_max:setText(string.format("(满分%s)", info.confScore))
    local spineParentDown = self.view:getChildAutoType("spineParentDown")
	local spineParentUp = self.view:getChildAutoType("spineParentUp")
	--local spineDown =  SpineUtil.createSpineObj(spineParentDown,cc.p(0,0), "gongnengjiesuo_down", "Spine/ui/jiesuan", "efx_gongnengjiesuo", "efx_gongnengjiesuo",true)
	local spineUp =  SpineUtil.createSpineObj(spineParentUp,cc.p(0,0), "gongnengjiesuo_up", "Spine/ui/jiesuan", "efx_gongnengjiesuo", "efx_gongnengjiesuo",true)
end

return CooperationEndLayerView
