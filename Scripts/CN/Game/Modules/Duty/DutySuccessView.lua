--Name : DutySuccessView.lua
--Author : generated by FairyGUI
--Date : 2020-6-13
--Desc : 职级升级成功页面 added by xhd

local DutySuccessView,Super = class("DutySuccessView", Window)
local ItemCell = require "Game.UI.Global.ItemCell"
function DutySuccessView:ctor()
	--LuaLog("DutySuccessView ctor")
	self._packName = "Duty"
	self._compName = "DutySuccessView"
	self._rootDepth = LayerDepth.Top
	self.config =false
	self.preConfig = false
end

function DutySuccessView:_initEvent( )
	
end

function DutySuccessView:_initVM( )
	local vmRoot = self
	local viewNode = self.view
	---Do not modify following code--------
	--{vmFields}:Duty.DutySuccessView
		vmRoot.proList = viewNode:getChildAutoType("$proList")--list
		vmRoot.icon = viewNode:getChildAutoType("$icon")--loader
		vmRoot.itemList = viewNode:getChildAutoType("$itemList")--list
		vmRoot.preName = viewNode:getChildAutoType("$preName")--text
		vmRoot.nextName = viewNode:getChildAutoType("$nextName")--text
		vmRoot.bgLoader = viewNode:getChildAutoType("$bgLoader")--loader
	--{vmFieldsEnd}:Duty.DutySuccessView
	--Do not modify above code-------------
end

function DutySuccessView:_initUI( )
	self:_initVM()
	-- self.bgLoader:setURL("UI/Duty/duty_suc_bg.png")
	local curDutyIndex = DutyModel:getCurDutyIndex(  )
	self.config = DutyModel:getDutyConfig(curDutyIndex)
	self.preConfig = DutyModel:getDutyConfig( curDutyIndex -1)
    self.itemList:setItemRenderer(function (index,obj)
		    local itemcell = BindManager.bindItemCell(obj)
	        local itemData = ItemsUtil.createItemData({data = self.config.reward[index+1]})
			itemcell:setItemData(itemData)
		end)
	self.itemList:setData(self.config.reward)

	self.icon:setURL(PathConfiger.getDutyIcon(curDutyIndex))
	local proData = {}
    proData[1] = {}
    proData[1].name = Desc.common_fightAttr1
    proData[1].value = self.config.hp
    proData[2] = {}
    proData[2].name = Desc.common_fightAttr2
    proData[2].value = self.config.attack
    proData[3] = {}
    proData[3].name = Desc.common_fightAttr4
    proData[3].value = self.config.magic
    proData[4] = {}
    proData[4].name = Desc.common_fightAttr3
    proData[4].value = self.config.defense
    proData[5] = {}
    proData[5].name = Desc.common_fightAttr5
    proData[5].value = self.config.magicDefense
    proData[6] = {}
    proData[6].name = Desc.common_fightAttr6
    proData[6].value = self.config.speed
   
	self.proList:setItemRenderer(function (index,obj)
	   local txt = obj:getChildAutoType("txt")
	   local val = obj:getChildAutoType("val")
	   txt:setText(proData[index+1].name)
	   val:setText("+"..proData[index+1].value)
	end)
	self.proList:setNumItems(#proData)
    
    self.nextName:setText(self.config.dutyName)
    self.preName:setText(self.preConfig.dutyName)


end




return DutySuccessView