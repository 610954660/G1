--Name : WorldChallengeRewardView.lua
--Author : generated by FairyGUI
--Date : 2020-5-26
--Desc : 

local WorldChallengeRewardView,Super = class("WorldChallengeRewardView", Window)
local ItemCell = require "Game.UI.Global.ItemCell"
function WorldChallengeRewardView:ctor()
	--LuaLog("WorldChallengeRewardView ctor")
	self._packName = "WorldChallenge"
	self._compName = "WorldChallengeRewardView"
	self._rootDepth = LayerDepth.PopWindow
	self.mode = self._args.mode or WorldChallengeModel.matchMode
end

function WorldChallengeRewardView:_initEvent( )
	self.list_mode:addClickListener(function()
		self.mode = self.list_mode:getSelectedIndex()
		self:showRewardList()
	end)
end

function WorldChallengeRewardView:_initVM( )
	local vmRoot = self
	local viewNode = self.view
	---Do not modify following code--------
	--{vmFields}:WorldChallenge.WorldChallengeRewardView
		vmRoot.list_function = viewNode:getChildAutoType("$list_function")--list
	--{vmFieldsEnd}:WorldChallenge.WorldChallengeRewardView
	--Do not modify above code-------------
end

function WorldChallengeRewardView:_initUI( )
	self.list_mode = self.view:getChildAutoType("list_mode")
	self.list_mode:setSelectedIndex(self.mode)
	self:_initVM()
	self.list_function:setVirtual()
	self:showRewardList()
end

function WorldChallengeRewardView:showRewardList()
	local configInfo=DynamicConfigData.t_PkReward;
	self.list_function:setItemRenderer(function(index,obj)
		local configItem=configInfo[index+1]
		local c1=obj:getController("c1")
		if index+1==1 then
			c1:setSelectedIndex(0)
		elseif index+1==2 then
			c1:setSelectedIndex(1)
		else
			c1:setSelectedIndex(2)
		local txt_desc=obj:getChildAutoType("$txt_desc");
		txt_desc:setText(configItem.desc)
		end
		local list_reward=obj:getChildAutoType("$list_reward");
		list_reward:setItemRenderer(function(indexItem,objItem)
			local itemcell = BindManager.bindItemCell(objItem)
			local award = self.mode == 0 and configItem.preReward[indexItem+1] or configItem.skyPvpPreReward[indexItem + 1]
			itemcell:setData(award.code, award.amount, award.type)
			itemcell:setFrameVisible(false) 
			objItem:removeClickListener(100)
			objItem:addClickListener(function( ... )
				itemcell:onClickCell()
			end,100)
		end)
		list_reward:setNumItems(#configItem.preReward);
	end)
	self.list_function:setNumItems(#configInfo);
end


return WorldChallengeRewardView