--Date :2021-01-02
--Author : generated by FairyGUI
--Desc : 

local TrialActivityTipsView,Super = class("TrialActivityTipsView", Window)

function TrialActivityTipsView:ctor()
	--LuaLog("TrialActivityTipsView ctor")
	self._packName = "TrialActivity"
	self._compName = "TrialActivityTipsView"
	self._rootDepth = LayerDepth.PopWindow
	
end

function TrialActivityTipsView:_initEvent( )
	
end

function TrialActivityTipsView:_initVM( )
	local viewNode = self.view
	---Do not modify following code--------
	--{autoFields}:TrialActivity.TrialActivityTipsView
	self.blackbg = viewNode:getChildAutoType('blackbg')--GLabel
	self.btn_sure = viewNode:getChildAutoType('btn_sure')--GButton
	self.c1 = viewNode:getController('c1')--Controller
	self.frame = viewNode:getChildAutoType('frame')--GLabel
	self.icon1 = viewNode:getChildAutoType('icon1')--GLoader
	self.icon2 = viewNode:getChildAutoType('icon2')--GLoader
	self.icon3 = viewNode:getChildAutoType('icon3')--GLoader
	self.itemCell = viewNode:getChildAutoType('itemCell')--GButton
	self.money1 = viewNode:getChildAutoType('money1')--GTextField
	self.money2 = viewNode:getChildAutoType('money2')--GTextField
	self.money3 = viewNode:getChildAutoType('money3')--GTextField
	self.name = viewNode:getChildAutoType('name')--GTextField
	self.noTips = viewNode:getChildAutoType('noTips')--GLoader
	self.tipBtn = viewNode:getChildAutoType('tipBtn')--GLoader
	--{autoFieldsEnd}:TrialActivity.TrialActivityTipsView
	--Do not modify above code-------------
end

function TrialActivityTipsView:_initListener( )
	
	self.btn_sure:addClickListener(function()
		TrialActivityModel:reqExchange(self._args.exdata.id)
		self:closeView()
	end)

	self.tipBtn:addClickListener(function()
		TrialActivityModel.changeTips = not TrialActivityModel.changeTips 
		self.noTips:setVisible(not TrialActivityModel.changeTips)
	 end)

end

function TrialActivityTipsView:_initUI( )
	self:_initVM()
	self:_initListener()
	local data = self._args.exdata
	local num = #data.price
	for i = 1,num do
		local price = data.price[i]
		local icon = self["icon"..i]
		local money = self["money"..i]
		if price then
			local url = ItemConfiger.getItemIconByCode(price.code, price.type, false)
			local itemData = ItemsUtil.createItemData({data = {code = price.code, type = price.type}})
			icon:setURL(url)
			money:setText("x"..StringUtil.transValue(price.amount))
			icon:addClickListener(function()
				ViewManager.open("ItemTips", {codeType = price.type, id = price.code,data = itemData})
			end)
		end
	end
	if num > 0 then
		self.view:getController("c1"):setSelectedIndex(3-num)
	end
	local itemData = self._args.itemData
	local itemcell = BindManager.bindItemCell(self.itemCell)
	itemcell:setItemData(itemData)
	self.name:setText(itemData.__itemInfo.name)
end




return TrialActivityTipsView