--Date :2020-11-23
--Author : generated by FairyGUI
--Desc : 

local DreamMasterPvpRewardView,Super = class("DreamMasterPvpRewardView", Window)
local ItemCell = require "Game.UI.Global.ItemCell"

function DreamMasterPvpRewardView:ctor()
	--LuaLog("DreamMasterPvpRewardView ctor")
	self._packName = "DreamMasterPvp"
	self._compName = "DreamMasterPvpRewardView"
	self._rootDepth = LayerDepth.PopWindow
	self.showNumber = self._args.showNumber or 0

end

function DreamMasterPvpRewardView:_initEvent( )
	self.list_mode:addClickListener(function()
			self.showNumber = self.list_mode:getSelectedIndex()
			self:showRewardList()
		end)
end

function DreamMasterPvpRewardView:_initVM( )
	local viewNode = self.view
	---Do not modify following code--------
	--{autoFields}:DreamMasterPvp.DreamMasterPvpRewardView
	self.list_function = viewNode:getChildAutoType('$list_function')--GList
	self.blackBg = viewNode:getChildAutoType('blackBg')--GButton
	self.frame = viewNode:getChildAutoType('frame')--GLabel
	self.list_mode = viewNode:getChildAutoType('list_mode')--GList
	--{autoFieldsEnd}:DreamMasterPvp.DreamMasterPvpRewardView
	--Do not modify above code-------------
end

function DreamMasterPvpRewardView:_initUI( )
	self:_initVM()
	self.list_mode:setSelectedIndex(self.showNumber)
	self.list_function:setVirtual()
	self:showRewardList()
end



function DreamMasterPvpRewardView:showRewardList()
	local configInfo=DynamicConfigData.t_DreamMasterPvpReward[self.showNumber+1];
	self.list_function:setItemRenderer(function(index,obj)
			local configItem=configInfo[index+1]
			local c1=obj:getController("c1")
			if index+1==1 then
				c1:setSelectedIndex(0)
			elseif index+1==2 then
				c1:setSelectedIndex(1)
			else
				c1:setSelectedIndex(2)
				local txt_desc=obj:getChildAutoType("$txt_desc");
				txt_desc:setText(configItem.desc)
			end
			local list_reward=obj:getChildAutoType("$list_reward");
			list_reward:setItemRenderer(function(indexItem,objItem)
					local itemcell = BindManager.bindItemCell(objItem)
					local award = configItem.reward[indexItem+1]
					itemcell:setData(award.code, award.amount, award.type)
					itemcell:setFrameVisible(false)
					objItem:getChildAutoType("num"):setFontSize(20)
					objItem:removeClickListener(100)
					objItem:addClickListener(function( ... )
							itemcell:onClickCell()
						end,100)
				end)
			list_reward:setNumItems(#configItem.reward);
		end)
	self.list_function:setNumItems(#configInfo);
end

return DreamMasterPvpRewardView