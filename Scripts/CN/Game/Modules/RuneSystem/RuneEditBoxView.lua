--Name : RuneEditBoxView.lua
--Author : generated by FairyGUI
--Date : 2020-5-22
--Desc : 

local RuneEditBoxView,Super = class("RuneEditBoxView", Window)

function RuneEditBoxView:ctor()
	--LuaLog("RuneEditBoxView ctor")
	self._packName = "RuneSystem"
	self._compName = "RuneEditBoxView"
	self._rootDepth = LayerDepth.PopWindow
	--self._rootDepth = LayerDepth.Window
	
	self.txt_input = false
	
end

function RuneEditBoxView:_initEvent( )
	self.ConfirmlBtn:addClickListener(function( ... )
		self:sendRename()
		ViewManager.close("RuneEditBoxView")
	end)

	self.CancelBtn:addClickListener(function( ... )
		ViewManager.close("RuneEditBoxView")
	end)

	self.txt_input:setText(self._args.name)
	self.txt_input:setMaxLength(4)

end

function RuneEditBoxView:_initVM( )
	local vmRoot = self
	local viewNode = self.view
	---Do not modify following code--------
	--{vmFields}:RuneSystem.RuneEditBoxView
		vmRoot.ConfirmlBtn = viewNode:getChildAutoType("$ConfirmlBtn")--Button
		vmRoot.edittext = viewNode:getChildAutoType("$edittext")--text
		vmRoot.CancelBtn = viewNode:getChildAutoType("$CancelBtn")--Button
	--{vmFieldsEnd}:RuneSystem.RuneEditBoxView
	--Do not modify above code-------------
end

function RuneEditBoxView:sendRename( ... )
	local nametext = self.txt_input:getText();
	print(33,"nametext = ",nametext)
	if nametext == self._args.name then
    local allData = RuneSystemModel:getAllRunePages()
	elseif nametext ~= "" then
		if nametext =="" then
			for i=1,10 do
				if self.allData[i] then
					if self.allData[i].name~="" then
						if nametext==self.allData[i].name then
							RollTips.show(Desc.Rune_txt42)
							return
						end
					end
				else
					if nametext==Desc.Rune_txt4..i then
						RollTips.show(Desc.Rune_txt42)
						return
					end
				end
			end
		end
		RPCReq.Rune_PageRename({id=self._args.id,name = nametext},function( ... )
			ModelManager.RuneSystemModel:setRuneArrDataName(self._args.id,"name",nametext)
			RollTips.show(Desc.Rune_txt27..nametext)
			Dispatcher.dispatchEvent("change_packageviewName",{name=nametext})
		end)
	end
	
end

function RuneEditBoxView:_initUI( )
	self:_initVM()
	self.txt_input = BindManager.bindTextInput(self.edittext)
end

return RuneEditBoxView