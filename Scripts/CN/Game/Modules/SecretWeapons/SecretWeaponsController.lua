--Name : SecretWeaponsController.lua
--Author : generated by FairyGUI
--Date : 2020-7-28
--Desc : 

local SecretWeaponsController = class("SecretWeaponsController",Controller)

function SecretWeaponsController:init()
	self.succeed=0
end

--#通知下发 在激活神器 时候下发
function SecretWeaponsController:GodArms_notify(_,data)
	printTable(6,'&^&^&^&在激活神器 时候下发',data)
	if data and data.data then
		local mode=data.data
		local info= SecretWeaponsModel.secretWeaponsInfo
		if not info then
			return 
		end
		if not info.godArmsMap then
			info.godArmsMap={}
		end
		self.succeed=mode.id
		info.godArmsMap[mode.id]=mode
		SecretWeaponsModel.secretWeaponsInfo=info
		Dispatcher.dispatchEvent(EventType.SecretWeaponsMainView_refresh)
	end
end

function SecretWeaponsController:pushMap_figthendInfo(_,data)
	if self.succeed~=0 then
		ViewManager.open("SecretWeaponsGetView",{id=self.succeed})
		self.succeed=0
	end
end

-- function SecretWeaponsController:Hero_ModuleInfoUpdate(_,data)
-- 	if data then
-- 		local cardfight=CardLibModel.cardfight
-- 		local maxConbat=data.maxCombat
-- 		local addNum=maxConbat-cardfight
-- 		printTable(153,"@@@@@@@@@@",data,cardfight,addNum)
-- 		RollTips.showAddFightPoint(addNum)
-- 	end	
-- end


function SecretWeaponsController:pack_item_change(_,data)
	local configCost=DynamicConfigData.t_godArmsCost
	local tupoCost=SecretWeaponsModel:getupLevelcost(2)
	--printTable(150,"当前大样图的商店",tupoCost)
	if data[1] and data[1].itemCode and tupoCost and data[1].itemCode==configCost[1].cost[1].code  then
		SecretWeaponsModel:getEquipUpLvRed()--升级突破红点
		SecretWeaponsModel:getPromoteRed()--秘武炼化提升红点
	elseif data[1] and data[1].itemCode and tupoCost and data[1].itemCode==configCost[2].cost[1].code then
		SecretWeaponsModel:getEquipUpLvRed()--升级突破红点
		SecretWeaponsModel:getPromoteRed()--秘武炼化提升红点
	elseif data[1] and data[1].itemCode and tupoCost and data[1].itemCode==configCost[3].cost[1].code  then
		SecretWeaponsModel:getEquipUpLvRed()--升级突破红点
		SecretWeaponsModel:getPromoteRed()--秘武炼化提升红点
	elseif data[1] and data[1].itemCode and tupoCost and  tupoCost[1] and data[1].itemCode==tupoCost[1].code then
		SecretWeaponsModel:getEquipUpLvRed()--升级突破红点
		SecretWeaponsModel:getPromoteRed()--秘武炼化提升红点
	end
	if data[1] and data[1].itemCode ==10000107 then
		SecretWeaponsModel:redCheck()
	end
	SecretWeaponsModel:onCheckIllusionActiveRed()
end

function SecretWeaponsController:money_change(_,data)
	SecretWeaponsModel:redCheck()
end

return SecretWeaponsController