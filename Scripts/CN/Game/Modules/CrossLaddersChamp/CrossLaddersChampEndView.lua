--Date :2021-01-20
--Author : generated by FairyGUI
--Desc : 

local CrossLaddersChampEndView,Super = class("CrossLaddersChampEndView", View)

function CrossLaddersChampEndView:ctor()
	--LuaLog("CrossLaddersChampEndView ctor")
	self._packName = "CrossLaddersChamp"
	self._compName = "CrossLaddersChampEndView"
	--self._rootDepth = LayerDepth.Window
	
end

function CrossLaddersChampEndView:_initEvent( )
	
end

function CrossLaddersChampEndView:_initVM( )
	local viewNode = self.view
	---Do not modify following code--------
	--{autoFields}:CrossLaddersChamp.CrossLaddersChampEndView
	self.heroCell1 = viewNode:getChildAutoType('heroCell1')--GButton
	self.heroCell2 = viewNode:getChildAutoType('heroCell2')--GButton
	self.rankCtrl = viewNode:getController('rankCtrl')--Controller
	self.txt_LInterage = viewNode:getChildAutoType('txt_LInterage')--GRichTextField
	self.txt_RInterage = viewNode:getChildAutoType('txt_RInterage')--GRichTextField
	self.txt_addRank = viewNode:getChildAutoType('txt_addRank')--GTextField
	self.txt_curRank = viewNode:getChildAutoType('txt_curRank')--GTextField
	self.txt_danTitle = viewNode:getChildAutoType('txt_danTitle')--GTextField
	self.txt_myName = viewNode:getChildAutoType('txt_myName')--GTextField
	self.txt_myPower = viewNode:getChildAutoType('txt_myPower')--GTextField
	self.txt_otherName = viewNode:getChildAutoType('txt_otherName')--GTextField
	self.txt_otherPower = viewNode:getChildAutoType('txt_otherPower')--GTextField
	self.txt_rankTitle = viewNode:getChildAutoType('txt_rankTitle')--GTextField
	self.txt_tips = viewNode:getChildAutoType('txt_tips')--GTextField
	--{autoFieldsEnd}:CrossLaddersChamp.CrossLaddersChampEndView
	--Do not modify above code-------------
end

function CrossLaddersChampEndView:_initListener( )
	local enemyInfo 	=  	CrossLaddersChampModel.enemyInfo
	local flagStage 	= 	CrossLaddersChampModel.flagStage or 2
	local SkyLadChampionWinSorce = DynamicConfigData.t_SkyLadChampionWinSorce
	local addScore 	= 0
	if SkyLadChampionWinSorce and SkyLadChampionWinSorce[flagStage-1] and SkyLadChampionWinSorce[flagStage-1].score then
		addScore = SkyLadChampionWinSorce[flagStage-1].score or 0
	end
	
	self.txt_otherName:setText(enemyInfo.name)
	self.txt_otherPower:setText(StringUtil.transValue(enemyInfo.combat or 0))

	self.txt_myPower:setText(StringUtil.transValue(CardLibModel:getFightVal() or 0))
	self.txt_myName:setText(PlayerModel.username)
	local reqInfo = {
		rankType = GameDef.RankType.SkyLadChampion,
	}
	RPCReq.Rank_GetMyRankData(reqInfo,function(data) 
		local data = data.rankData
		self.txt_curRank:setText(string.format(Desc.CrossLaddersChamp_str32,data.rank))
	end)
	-- self.txt_addRank:setText(1)
	self.txt_LInterage:setText(string.format("%s[color=#6aff60]（+%s）[/color]",CrossLaddersChampModel.myScore,addScore))
	self.txt_RInterage:setText(enemyInfo.score or 0)
	local heroCell1 = BindManager.bindPlayerCell(self.heroCell1)
	heroCell1:setHead(PlayerModel.head, PlayerModel.level,tonumber(PlayerModel.userid),nil,PlayerModel.headBorder)
	local heroCell2 = BindManager.bindPlayerCell(self.heroCell2)
	heroCell2:setHead(enemyInfo.head, enemyInfo.level,enemyInfo.playerId,nil,enemyInfo.headBorder)
	self.heroCell1:addClickListener(function()

	end)

	self.heroCell2:addClickListener(function()

	end)

end

function CrossLaddersChampEndView:_initUI( )
	self:_initVM()
	self:_initListener()

end




return CrossLaddersChampEndView