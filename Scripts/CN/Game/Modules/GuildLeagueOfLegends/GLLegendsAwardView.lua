--Date :2020-12-31
--Author : generated by FairyGUI
--Desc : 

local GLLegendsAwardView,Super = class("GLLegendsAwardView", Window)

function GLLegendsAwardView:ctor()
	--LuaLog("GLLegendsAwardView ctor")
	self._packName = "GuildLeagueOfLegends"
	self._compName = "GLLegendsAwardView"
	self._rootDepth = LayerDepth.PopWindow
	
end

function GLLegendsAwardView:_initEvent( )
	
end

function GLLegendsAwardView:_initVM( )
	local viewNode = self.view
	---Do not modify following code--------
	--{autoFields}:GuildLeagueOfLegends.GLLegendsAwardView
	self.Group = viewNode:getChildAutoType('Group')--GGroup
	self.blackbg = viewNode:getChildAutoType('blackbg')--GLabel
	self.blackbg2 = viewNode:getChildAutoType('blackbg2')--GLabel
	self.c1 = viewNode:getController('c1')--Controller
	self.frame = viewNode:getChildAutoType('frame')--GLabel
	self.list_award = viewNode:getChildAutoType('list_award')--GList
	self.list_item1 = viewNode:getChildAutoType('list_item1')--GList
	self.list_item2 = viewNode:getChildAutoType('list_item2')--GList
	self.list_item3 = viewNode:getChildAutoType('list_item3')--GList
	self.txt_lv1 = viewNode:getChildAutoType('txt_lv1')--GTextField
	self.txt_lv2 = viewNode:getChildAutoType('txt_lv2')--GTextField
	self.txt_lv3 = viewNode:getChildAutoType('txt_lv3')--GTextField
	--{autoFieldsEnd}:GuildLeagueOfLegends.GLLegendsAwardView
	--Do not modify above code-------------
end

function GLLegendsAwardView:_initListener( )
	self.blackbg2:addClickListener(function()
		self.c1:setSelectedIndex(0);
	end)
end

function GLLegendsAwardView:_initUI( )
	self:_initVM()
	self:_initListener()
	local conf = DynamicConfigData.t_GLLegendsReward;
	self.list_award:setItemRenderer(function(index, obj)
		local c = conf[index + 1][1]
		local c1 = obj:getController("c1");
		if (index < 2) then
			c1:setSelectedIndex(index + 1);
		else
			c1:setSelectedIndex(4);
		end
		local txt_rank = obj:getChildAutoType("txt_rank");
		txt_rank:setText(c.desc);
		local list = obj:getChildAutoType("list_item");
		list:setItemRenderer(function(i, o)
			local a = c.reward[i + 1];
			if (not o.cell) then
				o.cell = BindManager.bindItemCell(o);
			end
			o.cell:setData(a.code, a.amount, a.code);
		end)
		list:setNumItems(#c.reward)
		local btn = obj:getChildAutoType("btn_tips");
		btn:removeClickListener();
		btn:addClickListener(function ()
			self.c1:setSelectedIndex(1);
			self:upTipsWin(index + 1);
		end)
	end)
	self.list_award:setNumItems(#conf)
end

function GLLegendsAwardView:upTipsWin(index)
	local conf = DynamicConfigData.t_GLLegendsReward[index];
	for i = 1, 3 do
		local c = conf[i];
		local txt_lv = self["txt_lv"..i];
		txt_lv:setText(Desc["GLOL_guessRewardLv"..i]);
		local list = self["list_item"..i];
		list:setItemRenderer(function(idx, obj)
			local a = c.reward[idx + 1];
			if (not obj.cell) then
				obj.cell = BindManager.bindItemCell(obj);
			end
			obj.cell:setData(a.code, a.amount, a.code);
		end)
		list:setNumItems(#c.reward)
	end
end

return GLLegendsAwardView